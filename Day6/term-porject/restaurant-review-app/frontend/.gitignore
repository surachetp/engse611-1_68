node_modules/

@echo off
:: ===========================================================
:: ðŸ”’ Secure Boot GUI Check & Log Script
:: Author: Noi Nong + GPT-5
:: Version: 3.0
:: ===========================================================

:: à¸•à¸£à¸§à¸ˆà¸ªà¸­à¸šà¸ªà¸´à¸—à¸˜à¸´à¹Œ Admin
net session >nul 2>&1
if %errorLevel% neq 0 (
    echo [âš ï¸] à¸à¸£à¸¸à¸“à¸²à¸£à¸±à¸™à¹„à¸Ÿà¸¥à¹Œà¸™à¸µà¹‰à¸”à¹‰à¸§à¸¢à¸ªà¸´à¸—à¸˜à¸´à¹Œ "Run as Administrator"
    pause
    exit /b
)

:: à¸ªà¸£à¹‰à¸²à¸‡à¹„à¸Ÿà¸¥à¹Œ PowerShell à¸Šà¸±à¹ˆà¸§à¸„à¸£à¸²à¸§
set "TempPS=%TEMP%\SecureBoot_GUI.ps1"
(
echo Add-Type -AssemblyName System.Windows.Forms
echo Add-Type -AssemblyName System.Drawing
echo
echo # à¸ªà¸£à¹‰à¸²à¸‡ Form
echo $form = New-Object System.Windows.Forms.Form
echo $form.Text = "ðŸ”’ Secure Boot Checker"
echo $form.Size = New-Object System.Drawing.Size(500,300)
echo $form.StartPosition = "CenterScreen"
echo
echo # à¹à¸ªà¸”à¸‡à¸œà¸¥ Secure Boot
echo $labelStatus = New-Object System.Windows.Forms.Label
echo $labelStatus.Location = New-Object System.Drawing.Point(20,20)
echo $labelStatus.Size = New-Object System.Drawing.Size(450,40)
echo $labelStatus.Font = New-Object System.Drawing.Font("Segoe UI",14,[System.Drawing.FontStyle]::Bold)
echo
echo Try {
echo     if (Get-Command Confirm-SecureBootUEFI -ErrorAction SilentlyContinue) {
echo         $sb = Confirm-SecureBootUEFI
echo     } else {
echo         $sb = $false
echo     }
echo
echo     if ($sb) {
echo         $labelStatus.Text = "[âœ…] Secure Boot ENABLED"
echo         $labelStatus.ForeColor = [System.Drawing.Color]::Green
echo     } else {
echo         $labelStatus.Text = "[âŒ] Secure Boot DISABLED"
echo         $labelStatus.ForeColor = [System.Drawing.Color]::Red
echo     }
echo
echo     # à¹à¸ªà¸”à¸‡à¸‚à¹‰à¸­à¸¡à¸¹à¸¥ Windows / UEFI
echo     $labelInfo = New-Object System.Windows.Forms.Label
echo     $labelInfo.Location = New-Object System.Drawing.Point(20,80)
echo     $labelInfo.Size = New-Object System.Drawing.Size(450,60)
echo     $labelInfo.Font = New-Object System.Drawing.Font("Segoe UI",10)
echo     $biosMode = (Get-WmiObject Win32_ComputerSystem).BootMode
echo     $osVer = (Get-ItemProperty "HKLM:\SOFTWARE\Microsoft\Windows NT\CurrentVersion").ProductName
echo     $labelInfo.Text = "Windows: $osVer`nBoot Mode: $biosMode"
echo     $form.Controls.Add($labelInfo)
echo
echo     # à¸›à¸¸à¹ˆà¸¡ Export Log
echo     $btnLog = New-Object System.Windows.Forms.Button
echo     $btnLog.Text = "ðŸ“„ Export Log"
echo     $btnLog.Location = New-Object System.Drawing.Point(20,160)
echo     $btnLog.Size = New-Object System.Drawing.Size(120,40)
echo     $btnLog.Add_Click({
echo         $folder = (New-Object System.Windows.Forms.FolderBrowserDialog)
echo         if ($folder.ShowDialog() -eq "OK") {
echo             $LogPath = Join-Path $folder.SelectedPath "SecureBoot.log"
echo             $TimeStamp = (Get-Date).ToString("yyyy-MM-dd HH:mm:ss")
echo             $Status = if ($sb) {"ENABLED âœ…"} else {"DISABLED âŒ"}
echo             "$TimeStamp - Secure Boot Status: $Status" | Out-File -FilePath $LogPath -Append
echo             [System.Windows.Forms.MessageBox]::Show("Log saved to $LogPath","Info",[System.Windows.Forms.MessageBoxButtons]::OK,[System.Windows.Forms.MessageBoxIcon]::Information)
echo         }
echo     })
echo     $form.Controls.Add($btnLog)
echo
echo     $form.Controls.Add($labelStatus)
echo
echo } Catch {
echo     $labelStatus.Text = "[âŒ] Error: $_"
echo     $labelStatus.ForeColor = [System.Drawing.Color]::Red
echo     $form.Controls.Add($labelStatus)
echo }
echo
echo [void]$form.ShowDialog()
) > "%TempPS%"

:: à¸£à¸±à¸™ PowerShell GUI
PowerShell.exe -NoProfile -ExecutionPolicy Bypass -File "%TempPS%"

:: à¸¥à¸šà¹„à¸Ÿà¸¥à¹Œà¸Šà¸±à¹ˆà¸§à¸„à¸£à¸²à¸§
del "%TempPS%"
